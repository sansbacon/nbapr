# nbapr/scripts/update_datafiles.py
# -*- coding: utf-8 -*-
# Copyright (C) 2021 Eric Truett
# Licensed under the MIT License

from io import StringIO
from pathlib import Path
import pandas as pd
from nbapr import sim
from nbapr.stats import get_stats


DATA = """
PLAYER_ID,PLAYER_NAME,TEAM_ABBREVIATION,AGE,GP,MIN,FGM,FGA,FG_PCT,WFGP,FG3M,FG3A,FTM,FTA,FT_PCT,WFTP,REB,AST,TOV,STL,BLK,PTS,probs
203932,Aaron Gordon,ORL,25.0,19,552.02,91,213,0.427,0.0017023415127182884,31,84,49,80,0.613,0.0035186912534978833,137,80,-53,14,16,262,0.0042870705948402305
201143,Al Horford,OKC,34.0,17,476.82166666666666,99,220,0.45,0.0018529956763434219,38,94,11,14,0.786,0.0007895529884480162,119,57,-22,18,16,247,0.004080579878839184
202692,Alec Burks,NYK,29.0,16,415.75666666666666,60,150,0.4,0.001123027682632377,34,80,33,41,0.805,0.0023681567051732797,76,37,-17,14,5,187,0.002746106070092208
203083,Andre Drummond,CLE,27.0,25,721.8033333333333,180,380,0.474,0.0033713291032623953,0,8,77,129,0.597,0.005525794647341609,337,64,-81,40,29,437,0.007814314142189067
2738,Andre Iguodala,MIA,37.0,24,510.97833333333335,36,101,0.356,0.0006729930559454957,25,80,5,11,0.455,0.0003591160220994475,90,57,-26,26,11,102,0.0027960753536796497
203952,Andrew Wiggins,GSW,25.0,27,866.045,182,388,0.469,0.003405993224399648,50,137,61,93,0.656,0.004377412642606013,126,59,-42,18,37,475,0.006155774832529416
203076,Anthony Davis,LAL,27.0,22,740.7783333333333,199,372,0.535,0.0037250828232915944,17,57,88,125,0.704,0.006314127861089186,189,69,-45,31,41,503,0.0073800222804217405
1630162,Anthony Edwards,MIN,19.0,26,708.7566666666667,138,361,0.382,0.0025811293915061675,47,145,46,57,0.807,0.0033004950850254716,88,57,-40,19,8,369,0.0044171377006487185
1628389,Bam Adebayo,MIA,23.0,24,803.44,170,304,0.559,0.0031807138712635938,2,5,125,147,0.85,0.008965344048216976,223,125,-72,24,23,467,0.007283023082869647
1627732,Ben Simmons,PHI,24.0,24,796.7183333333334,131,234,0.56,0.0024526924588691114,1,6,76,119,0.639,0.00545605223505776,198,189,-80,41,19,339,0.007055221937103368
202687,Bismack Biyombo,CHA,28.0,25,559.1683333333333,64,113,0.566,0.0011971100754300259,0,1,20,44,0.455,0.00143646408839779,149,33,-23,6,30,148,0.0033898280174833703
201933,Blake Griffin,DET,31.0,20,626.3666666666667,81,222,0.365,0.0015166488853950249,39,124,44,62,0.71,0.0031584989596039315,104,77,-32,14,2,245,0.00368376497976244
1626171,Bobby Portis,MIL,26.0,26,558.225,124,227,0.546,0.002319838284013701,26,56,18,27,0.667,0.0012921719164813088,192,29,-19,21,11,292,0.0047243018262303465
202711,Bojan Bogdanovic,UTA,31.0,27,834.335,140,329,0.426,0.002623280363860969,74,182,72,84,0.857,0.005165243596182823,109,60,-39,11,1,426,0.004730915407881625
203078,Bradley Beal,WAS,27.0,21,740.8666666666667,241,515,0.468,0.004511202201134258,52,156,155,174,0.891,0.011123914759273875,105,94,-63,27,12,689,0.007421908297546508
1629634,Brandon Clarke,MEM,24.0,17,481.5416666666667,99,203,0.488,0.0018541935725382298,9,34,19,32,0.594,0.0013638516179952645,99,28,-11,21,13,226,0.0035110770144234867
1627742,Brandon Ingram,NOP,23.0,25,871.3416666666667,210,447,0.47,0.003932281430737268,63,159,115,133,0.865,0.008254645906579608,137,115,-61,15,25,598,0.007303598670229182
201572,Brook Lopez,MIL,32.0,26,711.2566666666667,106,228,0.465,0.00198438991521141,45,125,33,40,0.825,0.0023677979479084454,135,17,-20,13,36,290,0.00444212234244244
1628971,Bruce Brown,BKN,24.0,24,447.2733333333333,69,119,0.58,0.0012918561775881107,4,21,19,27,0.704,0.0013638516179952642,110,23,-20,13,8,161,0.0027225911131098825
1627741,Buddy Hield,SAC,28.0,25,874.3766666666667,135,359,0.376,0.0025265128118741463,99,264,37,43,0.86,0.0026533687307167967,121,76,-47,23,9,406,0.005248244461492788
203468,CJ McCollum,POR,29.0,13,439.98333333333335,123,260,0.473,0.002301832406835495,63,143,38,45,0.844,0.00272512018368372,51,65,-13,17,4,347,0.004083519248461975
1629629,Cam Reddish,ATL,21.0,22,621.7383333333333,82,222,0.369,0.001533269695097984,28,107,54,69,0.783,0.0038765157494439263,83,29,-29,25,6,246,0.0033295709402161614
1629661,Cameron Johnson,PHX,24.0,25,648.3383333333334,99,224,0.442,0.0018531454133677728,57,155,25,29,0.862,0.0017936428212671305,92,38,-20,17,7,280,0.003669802974054184
1627747,Caris LeVert,IND,26.0,12,333.68,87,200,0.435,0.0016283901398169464,22,63,26,34,0.765,0.0018662552916696563,52,72,-26,13,6,222,0.003111322745723952
2546,Carmelo Anthony,POR,36.0,24,605.01,109,273,0.399,0.002038800606434949,42,107,63,74,0.851,0.004518475999138983,82,28,-21,20,20,323,0.004132753689643718
1626224,Cedi Osman,CLE,25.0,27,706.5733333333334,108,288,0.375,0.0020214498287382783,54,160,26,34,0.765,0.0018662552916696563,84,70,-28,23,3,296,0.004054860394639765
1628449,Chris Boucher,TOR,28.0,26,605.3,127,238,0.534,0.0023787972373519005,41,93,65,88,0.739,0.004666140489344909,179,27,-18,13,53,360,0.005844201652513602
101108,Chris Paul,PHX,35.0,24,778.845,153,319,0.48,0.0028659666460778255,32,92,68,70,0.971,0.004876946258161728,112,197,-59,29,7,406,0.006502620448018717
1626174,Christian Wood,HOU,25.0,17,530.345,149,267,0.558,0.0027885900387444556,32,76,44,64,0.688,0.003159359977039535,174,22,-31,16,26,374,0.0052232598196990665
203991,Clint Capela,ATL,26.0,23,662.7016666666667,141,249,0.566,0.0026378797237351895,0,0,36,67,0.537,0.0025815455262969077,319,23,-32,18,51,318,0.006689270419065927
1629632,Coby White,CHI,20.0,25,836.0916666666667,140,344,0.407,0.0026205476631665633,62,171,47,54,0.87,0.003370883260386023,115,134,-60,10,3,389,0.005195335808282555
1630175,Cole Anthony,ORL,20.0,25,667.0166666666667,101,269,0.375,0.0018880902914256838,27,83,46,55,0.836,0.0032991318074191,111,94,-51,17,11,275,0.004278252485971859
1629012,Collin Sexton,CLE,22.0,22,769.6066666666667,185,381,0.486,0.003465775731371778,34,80,97,119,0.815,0.0069588146659969865,55,95,-55,22,4,501,0.005382720621735462
1626156,D'Angelo Russell,MIN,24.0,20,583.1083333333333,139,326,0.426,0.0025993598742208995,59,148,48,64,0.75,0.0034440697424122837,52,101,-54,22,10,385,0.004709604978116393
203081,Damian Lillard,POR,30.0,24,858.1466666666666,211,473,0.446,0.003948527897879349,95,251,180,191,0.942,0.012909664920714643,105,172,-73,25,6,697,0.008090614886731391
1627814,Damion Lee,GSW,28.0,27,515.775,58,128,0.453,0.0010852939524959291,40,101,18,20,0.9,0.0012915261534046066,90,41,-10,16,2,174,0.002847514322078487
1628464,Daniel Theis,BOS,28.0,25,602.2516666666667,95,163,0.583,0.0017786699608812022,23,55,26,39,0.667,0.001866470546028557,131,34,-26,15,26,239,0.003999012371806742
201980,Danny Green,PHI,33.0,27,759.235,84,210,0.4,0.0015722387556853278,58,158,10,14,0.714,0.0007172275238573582,99,49,-36,31,19,236,0.003985050366098486
1629647,Darius Bazley,OKC,20.0,25,772.5033333333333,108,280,0.386,0.0020229471989817883,35,125,41,54,0.759,0.002940805051302289,189,40,-47,10,19,292,0.004547204806457207
1629636,Darius Garland,CLE,21.0,19,610.9033333333333,120,264,0.455,0.002248301420630019,32,78,25,28,0.893,0.0017940733299849324,44,103,-47,17,3,297,0.0038013397646740675
1628021,David Nwaba,HOU,28.0,22,494.5033333333333,71,151,0.47,0.001328354577273663,13,48,29,43,0.674,0.0020795006098873504,67,24,-13,23,15,184,0.0029496574164704636
1628368,De'Aaron Fox,SAC,23.0,24,796.7483333333333,204,428,0.477,0.0038212139929249254,46,129,108,158,0.684,0.007754323025041258,81,160,-77,29,12,562,0.006945730418654416
1629631,De'Andre Hunter,ATL,23.0,18,578.6733333333333,108,210,0.514,0.002020326801055646,30,82,64,73,0.877,0.00459359977039535,97,40,-25,17,9,310,0.003963739936333254
201599,DeAndre Jordan,BKN,32.0,26,550.8333333333334,81,103,0.786,0.0015153012521758663,0,0,20,38,0.526,0.0014341680419028486,182,46,-45,9,36,182,0.004110708417472788
201942,DeMar DeRozan,SAS,31.0,24,799.71,161,328,0.491,0.0030143560372096504,15,45,150,168,0.893,0.010764439979909593,123,163,-40,17,8,487,0.006717194430482439
202326,DeMarcus Cousins,HOU,30.0,23,449.3983333333333,69,188,0.367,0.001291406966515058,33,101,39,54,0.722,0.0027974456482743773,176,56,-37,19,16,210,0.004212116669459068
1629028,Deandre Ayton,PHX,22.0,25,801.5566666666666,152,262,0.58,0.002844254777546933,3,14,43,60,0.717,0.0030867475066370096,308,45,-54,8,26,350,0.0061366689299812765
1627749,Dejounte Murray,SAS,24.0,26,788.72,157,352,0.446,0.002938439365863702,28,84,41,52,0.788,0.00294008753677262,182,130,-45,40,2,383,0.006447507267591392
1626153,Delon Wright,DET,28.0,26,748.3266666666667,93,212,0.439,0.0017419656727871676,23,65,56,73,0.767,0.004017435603070962,119,127,-31,37,15,265,0.005315115120411276
203471,Dennis Schroder,LAL,27.0,27,841.5683333333334,135,308,0.438,0.0025250154416306364,26,86,85,103,0.825,0.0060970797158642455,103,118,-58,23,4,381,0.005177699590545812
1627756,Denzel Valentine,CHI,27.0,21,403.20166666666665,69,168,0.411,0.0012923802571733391,39,101,4,4,1.0,0.0002870058118676903,78,36,-12,17,1,181,0.0027233259555155803
202324,Derrick Favors,UTA,29.0,25,413.8516666666667,62,100,0.62,0.0011604619387201227,0,1,31,40,0.775,0.0022242950419746003,141,24,-15,12,27,155,0.0033964415991346495
1627884,Derrick Jones Jr.,POR,23.0,21,555.8866666666667,56,122,0.459,0.0010481217362007973,15,54,24,41,0.585,0.001720958599411638,95,13,-15,18,17,151,0.0027519848093377893
201565,Derrick Rose,NYK,32.0,18,404.3933333333333,96,215,0.447,0.0017988095906564096,16,46,49,59,0.831,0.003517901987515247,34,75,-34,23,5,257,0.003382479593426394
1626164,Devin Booker,PHX,24.0,21,738.6016666666667,187,383,0.488,0.0034983060999120297,46,126,92,112,0.821,0.006597689603214466,79,88,-79,19,7,512,0.005421667269237439
1630170,Devin Vassell,SAS,20.0,25,443.965,50,125,0.4,0.0009358564021936474,25,62,18,21,0.857,0.0012913108990457057,82,27,-12,28,9,143,0.0027990147233024404
1628984,Devonte' Graham,CHA,25.0,24,801.1,107,303,0.353,0.0020019652984446063,69,197,55,71,0.775,0.0039481236995049145,71,139,-35,25,0,338,0.004935936439071277
1628415,Dillon Brooks,MEM,25.0,21,612.045,125,323,0.387,0.0023396597226121624,41,131,32,42,0.762,0.0022963335007533904,71,57,-47,28,9,323,0.004098216096575929
1627734,Domantas Sabonis,IND,24.0,27,966.4383333333334,217,409,0.531,0.004064967151440283,28,77,100,144,0.694,0.007170553203702374,310,151,-87,25,14,562,0.008748298839830809
1628378,Donovan Mitchell,UTA,24.0,25,839.4133333333333,206,478,0.431,0.003856065285342617,87,219,106,126,0.841,0.007603214465092918,108,127,-75,20,9,605,0.006886208183792904
1628978,Donte DiVincenzo,MIL,24.0,26,670.4016666666666,93,224,0.415,0.001739944222958429,49,122,12,17,0.706,0.0008611609385090047,114,68,-31,33,6,247,0.0042018288757793
203926,Doug McDermott,IND,29.0,27,705.59,140,272,0.515,0.0026218952963857228,43,119,35,44,0.795,0.002509865824782952,112,37,-28,7,2,358,0.004018853116760579
203110,Draymond Green,GSW,30.0,23,665.2033333333334,44,124,0.355,0.000823927976491287,8,43,23,34,0.676,0.0016491353949917487,127,183,-62,31,13,119,0.004525894376691974
1629130,Duncan Robinson,MIA,26.0,26,856.0716666666667,103,247,0.417,0.0019278454713908696,85,213,35,41,0.854,0.002512305374183827,98,42,-39,10,7,326,0.0038108927159481378
1628407,Dwayne Bacon,ORL,25.0,27,669.65,106,259,0.409,0.0019827240908155052,28,74,37,48,0.771,0.0026553777713998706,86,29,-19,20,2,277,0.0034589032036189517
2730,Dwight Howard,PHI,35.0,27,445.3,56,100,0.56,0.0010481591704568853,3,7,38,76,0.5,0.002726555212743058,205,19,-49,12,24,153,0.003575008303719184
203901,Elfrid Payton,NYK,26.0,28,783.5783333333334,145,331,0.438,0.002713571789544612,14,54,38,54,0.704,0.0027277032359905285,105,101,-54,18,6,342,0.004684620336322672
202683,Enes Kanter,POR,28.0,25,615.6683333333333,123,207,0.594,0.0023014206300185297,0,0,42,54,0.778,0.0030144220420463518,277,29,-31,14,21,288,0.005422402111643136
202339,Eric Bledsoe,NOP,31.0,24,701.9066666666666,116,261,0.444,0.002169015666236173,55,131,32,49,0.653,0.002295831240582622,85,89,-44,16,6,319,0.004236366468847091
201569,Eric Gordon,HOU,32.0,21,612.6133333333333,131,282,0.465,0.00245437700039306,57,162,76,90,0.844,0.00545024036736744,49,54,-39,12,11,395,0.004150389907380462
1629672,Eric Paschall,GSW,24.0,24,408.7316666666667,92,185,0.497,0.0017209463379938984,12,34,40,55,0.727,0.0028689818468823993,73,29,-16,4,2,236,0.0027123033194301153
203095,Evan Fournier,ORL,28.0,14,398.18666666666667,79,178,0.444,0.001479252063563367,31,88,60,75,0.8,0.004305087178015355,35,51,-29,14,6,249,0.002928346986705231
1627832,Fred VanVleet,TOR,26.0,26,942.8366666666668,174,422,0.412,0.003254234750219926,83,220,85,94,0.904,0.006097151467317214,111,172,-53,46,19,516,0.007709966520579996
202066,Garrett Temple,CHI,34.0,24,642.2,74,180,0.411,0.0013846931326857207,37,105,20,25,0.8,0.0014350290593384517,73,50,-26,26,10,205,0.0033038514560167426
1629018,Gary Trent Jr.,POR,22.0,23,677.6083333333333,122,282,0.433,0.0022854736369251503,73,162,23,30,0.767,0.0016510009327688887,51,31,-15,15,4,340,0.0035985232607015096
203507,Giannis Antetokounmpo,MIL,26.0,25,833.165,258,458,0.563,0.004826286334624815,28,100,159,251,0.633,0.01140008610174356,281,139,-89,26,31,703,0.00977854789261895
201609,Goran Dragic,MIA,34.0,17,451.00666666666666,89,195,0.456,0.0016643270256611825,28,78,38,47,0.809,0.0027282054961612974,52,90,-51,9,2,244,0.003111322745723952
202330,Gordon Hayward,CHA,30.0,26,921.5233333333332,210,432,0.486,0.003929698467067213,57,135,102,118,0.864,0.007315204132883691,142,100,-55,29,11,579,0.007086820160548369
1628977,Hamidou Diallo,OKC,22.0,25,596.175,120,236,0.508,0.00224395904692384,10,35,70,105,0.667,0.005025113008538424,130,60,-37,27,9,320,0.0046809461242941835
203084,Harrison Barnes,SAC,28.0,25,890.7666666666667,138,282,0.489,0.002581054522993992,45,109,93,109,0.853,0.006671234842505561,161,88,-36,19,5,414,0.005696498328968369
1630193,Immanuel Quickley,NYK,21.0,24,461.5866666666666,96,233,0.412,0.0017967694236996274,40,108,65,69,0.942,0.004663700939944034,57,63,-24,10,8,297,0.003599992945512905
1630191,Isaiah Stewart,DET,19.0,24,433.8233333333333,56,104,0.538,0.0010472607483107792,1,3,19,28,0.679,0.0013641386238071322,128,16,-17,12,21,132,0.0028776428607120916
1627826,Ivica Zubac,LAC,23.0,27,520.6816666666666,81,123,0.659,0.0015171542478522094,0,1,53,63,0.841,0.003801607232546459,176,28,-28,10,24,215,0.003984315523692789
1629630,Ja Morant,MEM,21.0,13,386.3133333333333,86,190,0.453,0.0016109832107361448,12,43,57,71,0.803,0.004090765588003157,30,102,-38,13,4,241,0.003255351857240696
203210,JaMychal Green,DEN,30.0,21,438.185,74,166,0.446,0.0013857412918561775,38,89,26,31,0.839,0.0018661835402166893,132,19,-24,12,3,212,0.003085603261524533
203109,Jae Crowder,PHX,30.0,22,614.69,71,188,0.378,0.0013301139873097873,50,143,28,33,0.848,0.002007892659826362,110,47,-19,19,3,220,0.0034500850947505796
1630256,Jae'Sean Tate,HOU,25.0,26,690.4666666666667,97,181,0.536,0.001815860894304378,16,52,29,40,0.725,0.0020807921360407548,130,42,-31,20,17,239,0.003953452142653487
1627751,Jakob Poeltl,SAS,25.0,26,563.6333333333333,77,125,0.616,0.0014412188593782168,0,0,10,36,0.278,0.0007180885412929612,178,44,-28,15,37,164,0.004200359190967905
1628973,Jalen Brunson,DAL,24.0,23,543.7016666666667,98,188,0.521,0.0018333052576412676,26,63,47,53,0.887,0.003373107555427997,74,85,-28,9,0,269,0.0035588417707938355
1627750,Jamal Murray,DEN,23.0,23,800.6016666666667,158,358,0.441,0.0029550227413105735,46,137,58,74,0.784,0.004162732295328981,91,102,-46,25,6,420,0.00535847082234744
201935,James Harden,BKN,31.0,22,832.01,159,340,0.468,0.0029782694143410636,62,169,140,157,0.892,0.010048360479299707,155,246,-94,24,17,520,0.00811266015890232
201949,James Johnson,DAL,33.0,23,423.8833333333333,60,123,0.488,0.0011234768937054297,14,50,13,24,0.542,0.0009333429001937289,71,37,-25,20,19,147,0.0027901966144340683
1630164,James Wiseman,GSW,19.0,20,418.6183333333333,98,195,0.503,0.0018358695041832782,9,22,38,61,0.623,0.002726770467101959,122,14,-32,8,26,243,0.003530182916971626
1629020,Jarred Vanderbilt,MIN,21.0,24,446.0966666666667,61,100,0.61,0.0011417448106762497,1,2,22,47,0.468,0.0015782449594604292,138,43,-24,26,16,145,0.003505933117583603
1628386,Jarrett Allen,CLE,22.0,26,676.3866666666667,111,168,0.661,0.002078499635016003,1,4,94,125,0.752,0.006744636578890722,228,41,-38,12,44,317,0.005747202454961509
1627759,Jaylen Brown,BOS,24.0,23,767.0833333333334,229,447,0.512,0.004283676792632939,54,132,87,114,0.763,0.006241084881968859,129,81,-59,30,14,599,0.0069685105332310425
1628369,Jayson Tatum,BOS,22.0,20,718.895,195,426,0.458,0.003651861418383963,59,143,83,94,0.883,0.005955514099160508,141,90,-47,25,9,532,0.0065489155195776715
201145,Jeff Green,BKN,34.0,28,731.6083333333333,92,182,0.505,0.0017202912385123627,42,99,35,42,0.833,0.0025102963335007535,104,38,-24,20,6,261,0.0036506970715060446
203924,Jerami Grant,DET,26.0,26,941.4883333333332,202,459,0.44,0.003780111179740581,65,170,138,158,0.873,0.009896964913539499,143,78,-44,22,31,607,0.007426317351980694
202710,Jimmy Butler,MIA,31.0,14,448.5466666666667,80,185,0.432,0.001495872873266326,3,20,105,124,0.847,0.007535911602209944,101,97,-28,26,6,268,0.004428895179139882
203925,Joe Harris,BKN,29.0,28,873.1266666666667,154,296,0.52,0.0028809403485129245,92,187,14,21,0.667,0.0010050226017076847,98,54,-21,15,7,414,0.004832323659867905
204060,Joe Ingles,UTA,33.0,23,608.635,89,178,0.5,0.0016658243959046925,55,124,27,31,0.871,0.0019373609815598765,81,107,-36,8,4,260,0.003804279134296859
203954,Joel Embiid,PHI,26.0,22,710.7483333333333,207,381,0.543,0.0038722556011005676,26,65,212,249,0.851,0.015204061132237927,237,62,-73,28,27,652,0.008240522737493717
1628381,John Collins,ATL,23.0,26,825.6016666666667,185,341,0.543,0.003465719579987647,36,92,64,75,0.853,0.004590299203558872,202,42,-37,12,26,470,0.0062637966661669734
202322,John Wall,HOU,30.0,17,520.22,120,270,0.444,0.002243809309899489,36,96,55,75,0.733,0.003944536126856569,64,101,-54,16,11,331,0.004308381024605463
202685,Jonas Valanciunas,MEM,28.0,16,439.785,99,175,0.566,0.0018539315327456153,7,19,52,67,0.776,0.0037305015426562387,175,34,-38,12,14,257,0.004100420623793021
203903,Jordan Clarkson,UTA,28.0,27,697.22,174,385,0.452,0.0032571546221947705,82,221,40,41,0.976,0.002871206141924374,115,57,-50,24,7,470,0.005412114317963369
1628404,Josh Hart,NOP,25.0,25,699.7333333333333,72,163,0.442,0.0013484942070488704,34,98,31,44,0.705,0.0022257300710339383,191,53,-18,22,4,209,0.004245184577715463
1628367,Josh Jackson,DET,24.0,24,579.1633333333333,106,251,0.422,0.0019825556366631102,35,112,56,80,0.7,0.004018081366147665,93,48,-57,23,23,303,0.004170965494739998
1626196,Josh Richardson,DAL,27.0,18,576.16,80,189,0.423,0.0014963782357235106,29,95,42,45,0.933,0.003012484752816245,53,48,-23,15,4,231,0.0029437786772248823
201950,Jrue Holiday,MIL,30.0,23,746.5166666666667,150,299,0.502,0.0028094034851292417,43,111,34,43,0.791,0.0024404821697639376,110,124,-36,44,14,377,0.006121237239461625
203944,Julius Randle,NYK,26.0,28,1023.6766666666666,218,465,0.469,0.004081924869448032,45,115,145,180,0.806,0.01040970079644113,310,158,-90,22,6,626,0.009031213166024414
203200,Justin Holiday,IND,31.0,27,856.6883333333334,107,225,0.476,0.0020046044134987926,64,150,30,38,0.789,0.0021512520628542728,109,44,-19,33,9,308,0.00449576583805837
202695,Kawhi Leonard,LAC,29.0,23,792.0266666666666,224,437,0.513,0.004196024482003482,44,113,123,140,0.879,0.008829733802109493,135,115,-42,41,14,615,0.007881184801107555
1629640,Keldon Johnson,SAS,21.0,26,780.9533333333334,137,294,0.466,0.0025643214105227695,25,77,74,95,0.779,0.005309966276817106,180,58,-40,20,14,373,0.005423136954048834
203482,Kelly Olynyk,MIA,29.0,25,665.6733333333333,94,216,0.435,0.0017586613510023022,57,160,12,18,0.667,0.0008614479443208725,150,51,-33,19,18,257,0.004346592829701742
1626162,Kelly Oubre Jr.,GSW,25.0,27,784.32,136,339,0.401,0.0025443876691560448,43,145,61,80,0.763,0.004379708689100955,160,38,-38,27,22,376,0.005393743257820927
1629134,Kendrick Nunn,MIA,25.0,18,504.95666666666665,98,206,0.476,0.0018353267074700057,33,96,19,22,0.864,0.0013638516179952645,61,42,-39,22,4,248,0.0031098530609125563
203145,Kent Bazemore,GSW,31.0,25,385.99,56,109,0.514,0.0010486458157860257,23,51,20,25,0.8,0.0014350290593384517,75,38,-26,19,14,155,0.002755659021366278
201142,Kevin Durant,BKN,32.0,19,679.5083333333333,188,359,0.524,0.003520991259101204,49,113,126,145,0.869,0.00904104183109708,139,100,-67,14,27,551,0.006788474143835112
1628989,Kevin Huerter,ATL,22.0,26,818.6216666666667,122,281,0.434,0.0022826286334624818,60,148,16,21,0.762,0.0011481667503766952,99,100,-33,30,5,320,0.00485583861685023
203920,Khem Birch,ORL,28.0,27,581.0133333333333,68,133,0.511,0.0012720721732457374,2,10,46,60,0.767,0.0033020018655377775,163,33,-16,20,18,184,0.00387335432043244
203114,Khris Middleton,MIL,29.0,26,850.9383333333334,195,380,0.513,0.0036487169408725927,65,144,80,89,0.899,0.005740905503336443,153,160,-61,26,3,535,0.007235258326499299
204001,Kristaps Porzingis,DAL,25.0,16,478.07,127,270,0.47,0.002375203548767477,38,105,39,47,0.83,0.00279902418023965,132,22,-20,5,25,331,0.004353206411353021
203937,Kyle Anderson,MEM,27.0,21,594.145,101,224,0.451,0.0018908791435042207,33,92,39,50,0.78,0.002798306665709981,133,80,-32,17,16,274,0.004560431969759765
1628398,Kyle Kuzma,LAL,25.0,27,670.71,114,258,0.442,0.0021344264136110955,46,127,14,22,0.636,0.0010039463299131807,163,31,-33,9,18,288,0.004248123947338254
200768,Kyle Lowry,TOR,34.0,23,796.785,136,306,0.444,0.0025429838845527544,64,169,65,74,0.878,0.004661835402166894,125,151,-66,25,4,401,0.005867716609495927
202681,Kyrie Irving,BKN,28.0,19,675.9766666666667,198,377,0.525,0.0037045875680835534,52,127,77,81,0.951,0.005527086173495012,88,110,-45,19,15,525,0.006265266350978369
200746,LaMarcus Aldridge,SAS,35.0,18,480.0833333333333,107,225,0.476,0.0020046044134987926,24,67,16,21,0.762,0.0011481667503766952,78,35,-16,7,16,254,0.0033295709402161614
1630163,LaMelo Ball,CHA,19.0,27,737.2633333333333,145,328,0.442,0.0027135343552885244,48,136,55,69,0.797,0.003945827653009974,161,163,-70,40,9,393,0.006670164516517788
1626204,Larry Nance Jr.,CLE,28.0,19,635.0433333333333,70,145,0.483,0.0013108540625526419,24,63,12,21,0.571,0.0008603716725263687,129,61,-28,37,10,176,0.0039336113976996484
1628374,Lauri Markkanen,CHI,23.0,14,426.1666666666667,95,185,0.514,0.0017798117056918787,40,101,38,45,0.844,0.00272512018368372,85,12,-24,9,5,268,0.0029834601671325568
2544,LeBron James,LAL,36.0,27,937.33,252,506,0.498,0.004716491661519457,72,184,116,162,0.716,0.008322594532539283,214,214,-102,30,13,692,0.009529436317087437
1629022,Lonnie Walker IV,SAS,22.0,24,647.0516666666666,96,242,0.397,0.0017982293596870496,38,107,28,35,0.8,0.0020090406830738324,72,40,-26,12,9,258,0.003243594378749533
1628366,Lonzo Ball,NOP,23.0,22,677.5366666666666,112,267,0.419,0.0020939412656521984,62,165,17,23,0.739,0.0012195594460787831,99,105,-42,28,12,303,0.004830119132650811
101150,Lou Williams,LAC,34.0,25,522.4966666666667,99,231,0.429,0.0018548486720197652,26,66,58,67,0.866,0.004163162804046782,57,84,-34,21,3,282,0.0037800293349088353
1629652,Luguentz Dort,OKC,21.0,24,698.4033333333333,101,244,0.414,0.0018907294064798696,43,131,39,51,0.765,0.0027993829375044846,80,33,-31,22,6,284,0.0035456146074912772
1629029,Luka Doncic,DAL,21.0,26,917.125,257,551,0.466,0.004805922099313082,60,186,167,212,0.788,0.011986510726842219,226,245,-109,27,18,741,0.010329679696892205
1628379,Luke Kennard,LAC,24.0,27,579.685,79,171,0.462,0.0014786905497220506,42,94,11,13,0.846,0.0007891224797302145,75,46,-24,9,6,211,0.0028732338062779053
1627763,Malcolm Brogdon,IND,28.0,27,962.5066666666668,214,487,0.439,0.004001590955883729,70,181,73,81,0.901,0.0052364927889789765,116,178,-53,35,7,571,0.007717314944636973
1627736,Malik Beasley,MIN,24.0,26,835.9383333333334,200,439,0.456,0.0037468695603346627,86,219,59,69,0.855,0.0042329769677835975,134,63,-38,20,5,545,0.006152835462906624
201188,Marc Gasol,LAL,36.0,27,531.5583333333333,34,89,0.382,0.0006363449192355925,16,50,22,25,0.88,0.0015785319652722968,113,51,-24,11,34,106,0.0031532087628487193
203935,Marcus Smart,BOS,26.0,17,549.4233333333333,74,188,0.394,0.0013864151084657572,28,90,46,62,0.742,0.003300853842290306,47,103,-30,31,9,222,0.0038424909393931376
1628963,Marvin Bagley III,SAC,21.0,24,602.0283333333333,121,256,0.473,0.002266419600576488,25,67,33,67,0.493,0.0023700222429504196,177,22,-37,12,11,300,0.00424298005049837
203486,Mason Plumlee,DET,30.0,24,662.475,96,162,0.593,0.0017980796226626985,0,5,45,63,0.714,0.003227523857358111,212,76,-51,24,17,237,0.004977822456196043
1629008,Michael Porter Jr.,DEN,22.0,15,401.7383333333333,84,164,0.512,0.0015716398075879237,35,83,21,26,0.808,0.0015073545239291098,93,14,-16,17,17,224,0.0032524124876179054
1628969,Mikal Bridges,PHX,24.0,25,830.0183333333333,126,252,0.5,0.0023583581335279913,48,124,51,62,0.823,0.003661189639090191,133,54,-18,14,25,351,0.005074821653748137
201144,Mike Conley,UTA,33.0,23,674.435,131,291,0.45,0.0024510079173451628,64,156,53,65,0.815,0.003801033220922724,84,134,-46,32,2,379,0.005414318845180462
203488,Mike Muscala,OKC,29.0,23,432.8466666666667,74,175,0.423,0.0013855354034476948,44,121,25,27,0.926,0.0017939298270789985,85,21,-16,7,7,217,0.002766681657451743
1628970,Miles Bridges,CHA,22.0,27,710.5766666666667,103,219,0.47,0.0019265539895558423,36,96,30,32,0.938,0.002153691612255148,156,52,-46,19,21,272,0.004491356783624184
1629011,Mitchell Robinson,NYK,22.0,27,777.6566666666666,103,156,0.66,0.0019271155033971589,0,0,22,46,0.478,0.0015776709478366937,226,14,-22,32,41,228,0.005270289733663718
1628420,Monte Morris,DEN,25.0,25,651.5266666666666,105,212,0.495,0.0019641754169240273,31,82,33,44,0.75,0.002367797947908445,51,85,-16,17,6,274,0.003789582286182905
1626149,Montrezl Harrell,LAL,27.0,27,671.03,148,230,0.643,0.00276807606640837,0,4,69,95,0.726,0.00494869771112865,171,28,-33,19,20,365,0.005115972828467207
1626167,Myles Turner,IND,24.0,25,775.8783333333333,121,236,0.513,0.00226604525801561,38,112,58,77,0.753,0.004160220994475138,169,25,-35,28,84,338,0.006461469273299648
1629675,Naz Reid,MIN,21.0,24,533.7483333333333,118,224,0.527,0.0022095195313231136,26,67,45,61,0.738,0.003230106909664921,120,31,-29,16,30,307,0.0044568191905563935
203457,Nerlens Noel,NYK,26.0,23,417.805,38,68,0.559,0.0007114754712036986,0,2,12,20,0.6,0.000861017435603071,120,9,-23,20,45,88,0.003067967043787789
1629638,Nickeil Alexander-Walker,NOP,22.0,21,429.3933333333333,73,184,0.397,0.0013672487693488313,23,86,25,32,0.781,0.0017932123125493293,58,45,-30,25,8,194,0.0029401044651963942
201587,Nicolas Batum,LAC,32.0,26,776.4616666666667,89,180,0.494,0.0016643270256611825,56,122,26,30,0.867,0.0018662552916696563,130,61,-19,35,9,260,0.004559697127354067
203999,Nikola Jokic,DEN,25.0,25,897.2166666666667,258,455,0.567,0.004828738278398562,36,92,115,135,0.852,0.008252852120255434,283,216,-87,40,16,667,0.010373035398828365
202696,Nikola Vucevic,ORL,30.0,27,908.1933333333334,259,531,0.488,0.004850131955752709,74,170,57,70,0.814,0.004088397790055248,310,95,-45,29,15,649,0.009189204283249415
1626181,Norman Powell,TOR,27.0,24,664.6616666666666,131,289,0.453,0.002450390252119715,56,132,72,82,0.878,0.005165817607806558,67,34,-32,27,4,390,0.0042797221707832536
1628384,OG Anunoby,TOR,23.0,17,592.3883333333333,86,177,0.486,0.0016100847885900389,42,97,35,47,0.745,0.002512377125636794,99,27,-30,35,9,249,0.0037499007962752307
203490,Otto Porter Jr.,CHI,27.0,16,371.5083333333333,64,144,0.444,0.0011966982986130609,28,70,30,36,0.833,0.002151682571572074,100,32,-15,9,3,186,0.002755659021366278
200782,P.J. Tucker,HOU,35.0,26,779.8133333333334,42,112,0.375,0.0007861193778426638,24,73,14,17,0.824,0.0010050943531606513,120,36,-27,22,14,122,0.002946718046847673
1629023,P.J. Washington,CHA,22.0,24,690.6483333333333,97,231,0.42,0.0018159357628165533,26,79,48,65,0.738,0.0034419171988232765,157,73,-49,22,31,268,0.0049667998201105784
1627783,Pascal Siakam,TOR,26.0,23,819.7483333333333,177,378,0.468,0.0033111348194733003,28,93,92,117,0.786,0.0065984071177441345,173,101,-51,26,14,474,0.006629013341798717
1630172,Patrick Williams,CHI,19.0,24,663.4916666666667,89,194,0.459,0.0016666853837947106,21,54,41,52,0.788,0.00294008753677262,105,25,-36,18,16,240,0.0034500850947505796
201988,Patty Mills,SAS,32.0,26,661.3066666666666,123,272,0.452,0.002301158590225916,68,167,33,35,0.943,0.0023681567051732797,49,71,-23,17,1,347,0.003992398790155463
202331,Paul George,LAC,30.0,20,679.8216666666667,168,331,0.508,0.0031472476463211482,75,157,76,84,0.905,0.005454545454545455,124,109,-72,24,9,487,0.0060720027982798805
200794,Paul Millsap,DEN,36.0,25,604.9816666666667,95,184,0.516,0.0017770790049974733,30,75,41,58,0.707,0.002942240080361627,129,41,-26,21,13,261,0.00406588303072523
1629628,RJ Barrett,NYK,20.0,28,952.7183333333334,174,412,0.422,0.003254234750219926,27,96,83,112,0.741,0.0059547965846308394,173,88,-53,20,5,458,0.006022768357098137
203493,Reggie Bullock,NYK,29.0,23,613.685,74,181,0.409,0.0013856102719598704,42,109,11,14,0.786,0.0007895529884480162,82,29,-16,17,5,201,0.002887195811986161
202704,Reggie Jackson,LAC,30.0,24,475.38166666666666,75,171,0.439,0.0014050760851254983,31,81,21,29,0.724,0.0015064935064935064,62,72,-22,14,3,202,0.0030378385051541843
1626158,Richaun Holmes,SAC,27.0,24,717.1766666666666,130,201,0.647,0.0024341063507215452,1,5,45,57,0.789,0.003226878094281409,191,44,-36,17,40,306,0.005409909790746277
201937,Ricky Rubio,MIN,30.0,24,584.5133333333333,50,143,0.35,0.000936792258595841,8,41,37,44,0.841,0.002655090765588003,83,150,-53,33,0,145,0.0037888474437772074
203496,Robert Covington,POR,30.0,23,702.92,57,166,0.343,0.001065715836562038,36,120,15,16,0.938,0.001076845806127574,138,41,-26,36,14,165,0.003792521655805696
1626220,Royce O'Neale,UTA,27.0,27,874.6916666666667,70,154,0.455,0.0013115091620341775,46,107,20,24,0.833,0.0014344550477147161,183,62,-31,19,19,206,0.004420811912677207
200752,Rudy Gay,SAS,34.0,25,552.4,103,248,0.415,0.0019263668182754035,40,109,32,42,0.762,0.0022963335007533904,132,37,-28,17,13,278,0.0040702920851594165
203497,Rudy Gobert,UTA,28.0,27,814.1283333333333,147,232,0.634,0.0027530649297171843,0,1,85,151,0.563,0.006099806271076989,361,34,-46,10,75,379,0.007878980273890461
1629060,Rui Hachimura,WAS,23.0,16,467.045,75,168,0.446,0.0014024369700713123,14,42,45,60,0.75,0.0032288153835115163,86,31,-17,7,2,209,0.002709363949807324
201566,Russell Westbrook,WAS,32.0,16,528.825,119,284,0.419,0.0022272633687087052,23,71,57,87,0.655,0.004088756547320083,144,143,-78,13,6,318,0.005028526582189183
201586,Serge Ibaka,LAC,31.0,26,632.0383333333333,122,236,0.517,0.002283714226889026,27,69,32,39,0.821,0.002297409772547894,171,44,-33,6,34,303,0.004858777986473021
203552,Seth Curry,PHI,30.0,20,563.2166666666667,89,181,0.492,0.0016667976865629738,42,87,33,34,0.971,0.002368802468249982,38,53,-25,16,6,253,0.003079724522278952
1628983,Shai Gilgeous-Alexander,OKC,22.0,21,708.8,167,330,0.506,0.003125386040765905,39,102,101,131,0.771,0.007246968501112149,116,137,-62,18,14,474,0.006266001193384067
1629003,Shake Milton,PHI,24.0,22,535.5866666666667,108,239,0.452,0.002021973908323507,22,72,70,80,0.875,0.005022601707684581,42,66,-34,16,4,308,0.0035522281891425564
201939,Stephen Curry,GSW,32.0,27,914.29,269,546,0.493,0.005038239092593632,133,310,137,147,0.932,0.009830236062280262,146,158,-89,33,2,808,0.009084121819234648
1628425,Sterling Brown,HOU,26.0,24,504.57166666666666,68,148,0.459,0.0012714919422763772,38,90,8,8,1.0,0.0005740116237353806,94,41,-14,24,5,182,0.003154678447660115
203500,Steven Adams,NOP,27.0,24,696.9033333333333,84,143,0.587,0.0015711344451307392,0,1,26,55,0.473,0.001866614048934491,217,56,-44,23,13,194,0.004426690651922788
204456,T.J. McConnell,IND,28.0,24,552.12,59,124,0.476,0.0011047597656615568,5,15,2,9,0.222,0.0001433594030279113,82,163,-41,42,7,125,0.004217260566298951
1627752,Taurean Prince,CLE,26.0,26,572.9083333333333,76,188,0.404,0.0014216033091882384,38,93,45,53,0.849,0.003228600129152615,95,45,-30,19,19,235,0.0036778862405168586
203082,Terrence Ross,ORL,30.0,26,740.0533333333333,135,333,0.405,0.002524285473636925,47,143,59,66,0.894,0.0042336227308603005,78,51,-45,25,12,376,0.004497970365275463
1626179,Terry Rozier,CHA,26.0,25,826.3566666666667,180,367,0.49,0.0033659011361296723,86,191,56,71,0.789,0.004019444643754036,99,75,-41,31,11,502,0.006013215405824067
201152,Thaddeus Young,CHI,32.0,21,537.835,108,183,0.59,0.002020888314896962,5,20,15,29,0.517,0.0010757695343330703,113,90,-41,28,10,236,0.004259146583423719
203501,Tim Hardaway Jr.,DAL,28.0,26,797.6883333333334,154,348,0.443,0.002885507327755629,81,204,49,63,0.778,0.0035168257157207434,85,43,-24,18,4,438,0.004750756152835463
1627789,Timothe Luwawu-Cabarrot,BKN,25.0,28,543.7083333333334,72,183,0.393,0.0013461171317872987,42,117,16,22,0.727,0.0011475927387529596,68,35,-20,18,5,202,0.002829878104341743
202699,Tobias Harris,PHI,28.0,24,821.6666666666666,185,359,0.515,0.00346051621839145,42,101,69,77,0.896,0.004950276243093923,176,74,-53,18,20,481,0.006350508070039299
1629027,Trae Young,ATL,22.0,24,825.7733333333333,177,420,0.421,0.0033095625807176145,54,147,217,245,0.886,0.015575087895529883,94,225,-99,17,7,625,0.007703352938928717
202684,Tristan Thompson,BOS,29.0,23,512.4983333333333,64,131,0.489,0.0011990005053624572,0,1,28,46,0.609,0.002010045203415369,189,21,-21,6,9,156,0.0032208142641729056
1629639,Tyler Herro,MIA,21.0,18,607.125,115,260,0.442,0.0021509723548018794,36,106,35,44,0.795,0.002509865824782952,106,72,-48,8,5,301,0.0038740891628381378
1630169,Tyrese Haliburton,SAC,20.0,23,672.755,106,214,0.495,0.001982705373687461,53,118,13,15,0.867,0.0009331276458348282,82,124,-37,28,15,278,0.004808808702885579
1630178,Tyrese Maxey,PHI,20.0,26,447.4616666666666,96,211,0.455,0.0017969378778520224,15,52,20,23,0.87,0.0014357465738681209,51,48,-17,15,3,227,0.002918794035431161
1626145,Tyus Jones,MEM,24.0,21,508.9716666666667,78,176,0.443,0.0014593370393246859,17,63,10,13,0.769,0.0007172992753103251,59,117,-21,27,3,183,0.00366171970759151
203506,Victor Oladipo,HOU,28.0,20,639.2733333333333,140,349,0.401,0.002619443352611975,48,146,54,73,0.74,0.0038760134892731578,104,92,-44,27,8,382,0.005186517699414183
1628976,Wendell Carter Jr.,CHI,21.0,14,377.16333333333336,65,122,0.533,0.0012170999681808824,4,15,45,62,0.726,0.0032296764009471187,112,34,-27,9,9,179,0.002876173175900696
203115,Will Barton,DEN,30.0,25,743.665,109,250,0.436,0.0020401669567821513,40,99,33,44,0.75,0.002367797947908445,93,80,-38,20,11,291,0.004244449735309765
1626161,Willie Cauley-Stein,DAL,27.0,25,437.6566666666667,62,96,0.646,0.0011607614127688247,1,5,26,42,0.619,0.0018653942742340533,115,20,-14,8,17,151,0.002792401141651161
203897,Zach LaVine,CHI,25.0,25,888.46,250,482,0.519,0.004682239317199168,89,207,113,131,0.863,0.008111717012269499,135,132,-95,27,12,702,0.007965691677762787
1629627,Zion Williamson,NOP,20.0,24,781.7466666666667,225,367,0.613,0.004210811013158141,4,13,129,184,0.701,0.009254789409485542,162,70,-57,24,17,583,0.00696924537563674
"""


def run():
    """Runs update script"""
    
    #pool = get_stats()        
    pool = pd.read_csv(StringIO(DATA))

    # run sim with specified parameters
    results = sim(
        pool=pool, 
        n_iterations=5000, 
        n_teams=10, 
        n_players=12
    )
    
    results.sort_values('pts', ascending=False).to_csv('../data/results.csv', index=False)


if __name__ == '__main__':
    run()
